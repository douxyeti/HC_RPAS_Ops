#:kivy 2.0.0
#:import MDButton kivymd.uix.button.MDButton
#:import MDTopAppBar kivymd.uix.appbar.MDTopAppBar
#:import MDGridLayout kivymd.uix.gridlayout.MDGridLayout
#:import MDScrollView kivymd.uix.scrollview.MDScrollView
#:import MDIconButton kivymd.uix.button.MDIconButton
#:import MDBoxLayout kivymd.uix.boxlayout.MDBoxLayout
#:import MDLabel kivymd.uix.label.MDLabel
#:import dp kivy.metrics.dp

<TaskManagerScreen>:
    name: 'task_manager'
    
    MDBoxLayout:
        orientation: 'vertical'
        spacing: dp(10)
        padding: dp(10)

        # En-tête avec titre et boutons
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(56)
            spacing: dp(10)
            padding: [dp(10), 0]
            md_bg_color: [0.2, 0.2, 0.9, 1]

            # Bouton retour
            MDIconButton:
                icon: "arrow-left"
                theme_text_color: "Custom"
                text_color: [1, 1, 1, 1]
                on_release: root.go_back()
                pos_hint: {"center_y": 0.5}

            # Titre
            MDLabel:
                text: "Gestion des Tâches"
                bold: True
                font_size: "24sp"
                theme_text_color: "Custom"
                text_color: [1, 1, 1, 1]
                size_hint_x: 0.9
                valign: "center"
                height: dp(56)

            # Bouton ajouter
            MDIconButton:
                icon: "plus"
                theme_text_color: "Custom"
                text_color: [1, 1, 1, 1]
                on_release: root.show_add_task_dialog()
                pos_hint: {"center_y": 0.5}

        # Sous-titre avec le nom du rôle
        MDLabel:
            text: f"Tâches pour le rôle : {root.current_role_name}"
            bold: True
            font_size: "20sp"
            size_hint_y: None
            height: dp(40)
            padding: [dp(10), 0]

        # Liste des tâches
        MDScrollView:
            do_scroll_x: False
            
            MDGridLayout:
                id: tasks_list
                cols: 1
                spacing: dp(10)
                padding: dp(10)
                size_hint_y: None
                height: self.minimum_height
                adaptive_height: True
